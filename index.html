<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Flashcards</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
/* ==== Styles g√©n√©raux ==== */
:root{
 --orange-1: #ff9f1c;
 --orange-2: #ff6b35;
 --bg-a: #a8edea;
 --bg-b: #fed6e3;
 --card-shadow: 0 8px 20px rgba(16,24,40,0.12);
}
html,body{
 height:100%;
 margin:0;
 font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
 color:#222;
 background: linear-gradient(90deg,var(--bg-a),var(--bg-b));
 -webkit-font-smoothing:antialiased;
}
main{flex:1;}
.hero{
 background: linear-gradient(90deg,var(--orange-1),var(--orange-2));
 color:white;
 padding:28px 20px 56px 20px;
 position:relative;
 overflow:visible;
 box-shadow:0 6px 20px rgba(0,0,0,0.08);
}
.hero-inner{
 max-width:1200px;
 margin:0 auto;
 display:flex;
 align-items:center;
 justify-content:space-between;
 gap:12px;
}
.hero-left{
 display:flex;
 flex-direction:column;
 gap:6px;
}
.hero-left .small{
 font-size:14px;
 opacity:0.95;
 letter-spacing:0.6px;
}
.hero-left h1{
 margin:0;
 font-size:34px;
 line-height:1;
 font-weight:700;
 letter-spacing:-0.6px;
 text-shadow:0 2px 10px rgba(0,0,0,0.08);}
.hero .create-btn{
 background: rgba(255,255,255,0.98);
 color: var(--orange-2);
 border:none;
 padding:10px 16px;
 border-radius:999px;
 font-weight:700;
 cursor:pointer;
 box-shadow:0 6px 18px rgba(0,0,0,0.12);
 transition: transform .14s ease;
 margin-left:6px;
}
.hero .create-btn:hover{ transform:translateY(-3px); }
.mini-card{
 width:120px; height:72px;
 border-radius:12px;
 box-shadow:var(--card-shadow);
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 font-weight:600;
 color:#333;
 transform-origin:center;
 border:1px solid rgba(0,0,0,0.04);}
.mini-card:nth-child(1){
 transform:rotate(-8deg) translateX(-20px);
 background: linear-gradient(180deg,#ffffff,#fff3f0);}
.mini-card:nth-child(2){
 transform:rotate(2deg); z-index:2;
 background: linear-gradient(180deg,#ffffff,#eefcff);}
.mini-card:nth-child(3){
 transform:rotate(8deg) translateX(20px);
 background: linear-gradient(180deg,#fffef6,#fff9e6);}
.mini-card .q{ font-size:14px; opacity:0.9; }
.mini-card .a{ font-size:11px; opacity:0.65; margin-top:6px; }
.container{
 max-width:1200px;
 margin:60px auto 40px;
 padding:0 18px;
}
.levels{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
 gap:18px;
}
.level-card{
 background:white;
 border-radius:16px;
 padding:20px;
 display:flex;
 gap:12px;
 align-items:center;
 box-shadow: var(--card-shadow);
 cursor:pointer;
 transition: transform .16s ease, box-shadow .16s ease;
 border:1px solid rgba(0,0,0,0.03);}
.level-card:hover{
 transform: translateY(-6px);
 box-shadow:0 14px 30px rgba(16,24,40,0.12);}
.icon-square{
 width:72px;
 height:72px;
 border-radius:12px;
 display:flex;
 align-items:center;
 justify-content:center;
 flex-shrink:0;
 box-shadow:0 6px 18px rgba(0,0,0,0.06);
 color:white;
 font-size:28px;}
.icon-blue{ background: linear-gradient(180deg,#4e73df,#6c8cff); }
.icon-teal{ background: linear-gradient(180deg,#06b6d4,#3dd6e9);}
.icon-green{ background: linear-gradient(180deg,#16a34a,#4ade80);}
.icon-amber{ background: linear-gradient(180deg,#f59e0b,#fbbf24);}
.level-body h3{ margin:0; font-size:18px; }
.level-body p{ margin:6px 0 0; font-size:13px; color:#666; }
.modal{
 display:none;
 position:fixed;
 inset:0;
 background:rgba(0,0,0,0.55);
 align-items:center;
 justify-content:center;
 z-index:60;
}
.modal .card{
 background:white;
 border-radius:12px;
 padding:20px;
 width:min(420px,92%);
 box-shadow:var(--card-shadow);
 position:relative;
}
.modal h2{ margin:0 0 12px; }
.chapter-list{
 list-style:none;
 padding:0; margin:0;
 display:flex; flex-direction:column; gap:8px;}
.chapter-list li{
 padding:10px 12px;
 border-radius:8px;
 background:#f7f7f8;
 cursor:pointer;
 border:1px solid rgba(0,0,0,0.03);}
.chapter-list li:hover{ background:#eef3ff;}
.modal .start-btn{
 margin-top:12px;
 background: linear-gradient(90deg,#2ecc71,#16a34c);
 color:white;
 border:none;
 padding:10px 14px;
 border-radius:10px;
 cursor:pointer;
 font-weight:700;}
.modal .close{
 position:absolute; top:8px; right:10px;
 font-size:20px; cursor:pointer; color:#666; }
.flashcard{
 width:220px; height:140px;
 perspective:1000px;
 cursor:pointer;
 margin:auto;
}
.flashcard-inner{
 width:100%; height:100%;
 position:relative;
 transition: transform .6s;
 transform-style:preserve-3d;
}
.flashcard.flipped .flashcard-inner{ transform: rotateY(180deg); }
.front, .back {
 position:absolute; inset:0;
 border-radius:12px;
 backface-visibility:hidden;
 display:flex; align-items:center; justify-content:center;
 text-align:center; padding:12px; font-weight:600;
 box-shadow:0 6px 14px rgba(0,0,0,0.08); }
.front{
 background: linear-gradient(180deg,#ffffff,#fff7ef); color:#222;
}
.back{
 background: linear-gradient(180deg,#eef7ff,#e6f0ff);
 color:#222;
 transform: rotateY(180deg);
}
@media (max-width:720px){
 .hero-inner{
  flex-direction:column; align-items:flex-start; gap:10px; padding-bottom:20px;}
 .hero-art{ left:50%; transform:translateX(-50%); bottom:-24px;}
 .level-card{ padding:16px;}
 .icon-square{ width:56px;height:56px; border-radius:10px; font-size:22px;}
 .mini-card{ width:100px; height:60px;}
}
</style>
</head>
<body>
<header class="hero" role="banner">
 <div class="hero-inner">
  <div class="hero-left">
   <div class="small">Les cartes</div>
   <h1>Flashcards</h1>
  </div>
  <div>
   <button class="create-btn" onclick="showLevels()">üìö √âtudier</button>
  </div>
 </div>
</header>

<main class="container" role="main">
 <section id="levelsSection">
  <div class="levels" id="levelsGrid">
   <article class="level-card" onclick="openModal('Seconde')">
    <div class="icon-square icon-blue">S</div>
    <div class="level-body"><h3>Seconde</h3><p class="muted">Bases / Fonctions / G√©om√©trie</p></div>
   </article>
   <article class="level-card" onclick="openModal('Premi√®re')">
    <div class="icon-square icon-teal">1</div>
    <div class="level-body"><h3>Premi√®re</h3><p class="muted">Suites / Probabilit√©s / Analyse</p></div>
   </article>
  </div>
 </section>
</main>

<!-- Modal Chapitres -->
<div class="modal" id="chapterModal" role="dialog" aria-modal="true" aria-hidden="true">
 <div class="card">
  <div class="close" onclick="closeModal()">‚úï</div>
  <h2 id="modalTitle">Chapitres</h2>
  <ul class="chapter-list" id="chapterList"></ul>
  <button class="start-btn" id="startRevisionBtn">‚ñ∂Ô∏è Commencer la r√©vision</button>
 </div>
</div>

<script>
// ==== Donn√©es chapitres ====
const chapters = {
 "Seconde":["Chapitre 1 : Bases","Chapitre 2 : Fonctions","Chapitre 3 : G√©om√©trie"],
 "Premi√®re":["Chapitre 1 : Suites","Chapitre 2 : Probabilit√©s","Chapitre 3 : Analyse"]
};
let currentLevel = null;
let selectedChapter = null;
let deck = [];

// ==== Ouvre modal de chapitres ====
function openModal(level){
 currentLevel = level;
 selectedChapter = null;
 document.getElementById('modalTitle').textContent = level + " ‚Äî Chapitres";
 const list = document.getElementById('chapterList');
 list.innerHTML = '';
 (chapters[level] || []).forEach(chap => {
  const li = document.createElement('li');
  li.textContent = chap;
  li.onclick = () => {
   Array.from(list.children).forEach(c => c.style.background = '');
   li.style.background = '#dfefff';
   selectedChapter = chap;
  };
  list.appendChild(li);
 });
 const modal = document.getElementById('chapterModal');
 modal.style.display = 'flex';
 modal.setAttribute('aria-hidden','false');
}

// ==== Ferme modal ====
function closeModal(){
 const modal = document.getElementById('chapterModal');
 modal.style.display = 'none';
 modal.setAttribute('aria-hidden','true');
 selectedChapter = null;
}

// ==== Bouton Commencer la r√©vision ====
document.getElementById('startRevisionBtn').onclick = () => {
 if(!selectedChapter){ alert("S√©lectionne un chapitre !"); return; }
 startRevision();
};

// ==== Fonction pour lancer la r√©vision ====
async function startRevision(){
 const level = currentLevel.toLowerCase().replace(/\s+/g,"").replace("√©","e").replace("√®","e");
 const chapNum = selectedChapter.split(":")[0].trim().toLowerCase().replace(/\s+/g,"");
 const stockPath = `./niveaux/${level}_${chapNum}.json`;

 try {
  const res = await fetch(stockPath);
  if(!res.ok) throw new Error("Fichier introuvable");
  deck = await res.json();
  if(deck.length===0){ alert("Aucune carte disponible !"); return; }

  closeModal();
  let idx=0, correct=0, incorrect=0;
  const shuffled = [...deck];
  shuffle(shuffled);

  const modal = document.createElement('div');
  modal.className='modal';
  modal.style.display='flex';
  modal.innerHTML=`
    <div class="card" style="max-width:500px;text-align:center;position:relative;">
      <div class="close" id="closeRevise">‚úï</div>
      <div id="reviseContent"></div>
      <div id="reviewInfo" style="margin-top:10px;">Carte 1/${shuffled.length} | ‚úîÔ∏è 0 | ‚ùå 0</div>
      <div id="reviewButtons" style="margin-top:12px;">
        <button id="correctBtn" class="btn btn-add">Correcte</button>
        <button id="incorrectBtn" class="btn btn-secondary">Incorrecte</button>
      </div>
    </div>`;
  document.body.appendChild(modal);

  const container = modal.querySelector('#reviseContent');
  const infoDiv = modal.querySelector('#reviewInfo');

  function updateInfo(){ infoDiv.textContent = `Carte ${idx+1}/${shuffled.length} | ‚úîÔ∏è ${correct} | ‚ùå ${incorrect}`; }

  function showCard(i){
    const c=shuffled[i];
    container.innerHTML = `<div class="flashcard"><div class="flashcard-inner">
      <div class="front">${c.frontImg?`<img src="${c.frontImg}" style="max-width:90%;max-height:100px"><br>`:''}${c.front||''}</div>
      <div class="back">${c.backImg?`<img src="${c.backImg}" style="max-width:90%;max-height:100px"><br>`:''}${c.back||''}</div>
    </div></div>`;
    const flash = container.querySelector('.flashcard');
    flash.addEventListener('click', ()=>flash.classList.toggle('flipped'));
  }

  showCard(idx);
  updateInfo();

  modal.querySelector('#correctBtn').onclick = () => { correct++; nextCard(); };
  modal.querySelector('#incorrectBtn').onclick = () => { incorrect++; nextCard(); };
  modal.querySelector('#closeRevise').onclick = () => { document.body.removeChild(modal); };

  function nextCard(){
    idx++;
    if(idx>=shuffled.length){ endRevision(); }
    else { showCard(idx); updateInfo(); }
  }

  function endRevision(){
    updateInfo();
    alert("R√©vision termin√©e !");
    document.body.removeChild(modal);
  }

 } catch(e){ alert("Impossible de charger les cartes : "+e.message); }
}

// ==== M√©lange tableau ====
function shuffle(array){ for(let i=array.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [array[i],array[j]]=[array[j],array[i]]; } return array; }

</script>
</body>
</html>
